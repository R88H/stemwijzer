<!doctype html>
<html lang="nl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="theme-color" content="#ffffff" />
  <title>Eenvoudige stemwijzer</title>
  <style>
    :root{
      --bg:#ffffff; --panel:#ffffff; --text:#0b1220; --muted:#5b6472; --line:#d7dbe3;
      --accent:#0a3d91; /* civic blauw */
      --accent-soft:#eef2ff;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{ margin:0; font-family: system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Helvetica,Arial; color:var(--text); background:var(--bg); -webkit-font-smoothing:antialiased }

    /* Header */
    header{ position:sticky; top:0; z-index:20; background:#fff; border-bottom:1.5px solid var(--line) }
    .header-inner{ max-width:980px; margin:0 auto; padding:12px 16px; display:flex; align-items:center; justify-content:space-between }
    header h1{ margin:0; font-size:18px; text-transform:lowercase; letter-spacing:.2px }
    .header-actions{ display:flex; gap:10px; align-items:center }

    /* Buttons */
    .btn{ background:#fff; border:1.5px solid var(--line); color:var(--text); padding:10px 14px; border-radius:6px; cursor:pointer; font-weight:600; transition: background .15s ease, border-color .15s ease }
    .btn:hover{ background:#f3f6fb }
    .btn-primary{ background:var(--accent); border-color:var(--accent); color:#fff }
    .btn-primary:hover{ filter:brightness(.95) }
    .btn-quiet{ background:#fff; border-color:#d1d5db; color:#374151 }  /* neutrale 'Volgende' */
    .btn-quiet:hover{ background:#f3f4f6 }
    .btn-link{ background:transparent; border:0; color:var(--muted); text-decoration:underline; padding:4px 6px }

    /* Layout */
    main{ max-width:980px; margin:24px auto; padding:0 16px }
    .card{ background:#fff; border:1.5px solid var(--line); border-radius:6px; padding:20px; box-shadow:none; margin-bottom:16px }
    .title{ font-size:20px; font-weight:800; margin:0 0 6px; letter-spacing:.2px }
    .subtitle{ font-size:14px; color:var(--muted); margin:0 0 8px }

    .row{ display:flex; gap:12px; align-items:center; flex-wrap:wrap }
    .pill{ padding:2px 8px; border-radius:999px; border:1.5px solid var(--line); color:var(--muted); font-size:12px }
    .status{ display:inline-flex; align-items:center; gap:8px; border:1.5px solid var(--line); background:#fff; padding:6px 10px; border-radius:999px; font-weight:800 }
    .status .emoji{ font-size:18px; display:inline-flex; align-items:center }
    .status svg{ width:18px; height:18px }
    .status.pop{ animation: pop .25s ease-out }
    @keyframes pop{ 0%{ transform:scale(.96) } 60%{ transform:scale(1.03) } 100%{ transform:scale(1) } }

    /* Voortgang ‚Äì moet 1:1 overeenkomen met Vraag x/30 */
    .progress{ height:10px; background:#f3f4f6; border:1.5px solid var(--line); border-radius:999px; overflow:hidden; position:relative; margin-top:10px }
    .progress .fill{ height:100%; width:0%; background:var(--accent); transition: width .35s ease }

    /* Vraag */
    .qwrap{ margin-top:10px; background:#fff; border:1.5px dashed var(--line); border-radius:10px; padding:14px }
    .question{ font-size:20px; line-height:1.38; font-weight:700; display:block; margin-bottom:8px }
    /* MEER witruimte tussen stelling en uitleg voor extra rust */
    .explain{ font-size:14px; color:var(--muted); display:none; margin-top:18px }

    .scale{ display:grid; grid-template-columns: repeat(5, 1fr); gap:10px; margin-top:16px }
    .option{ position:relative; display:flex; align-items:center; justify-content:center; text-align:center; border:1.5px solid var(--line); border-radius:10px; padding:16px; min-height:56px; cursor:pointer; user-select:none; background:#ffffff; transition: background .15s ease, border-color .15s ease }
    .option:hover{ background:#f6f8ff; border-color:#c9d4ef }
    .option.selected{ border-color:var(--accent); background:#e9efff }

    /* Korte ‚Äòvliegende‚Äô smiley in optie (0.4s) */
    .fly{ position:absolute; pointer-events:none; font-size:18px; opacity:0; transform:translateY(0) scale(.9); animation:floatUp .4s ease-out forwards }
    @keyframes floatUp{ 0%{ opacity:0; transform:translateY(6px) scale(.9) } 30%{ opacity:1 } 100%{ opacity:0; transform:translateY(-26px) scale(1.05) } }

    .quiz-actions{ margin-top:24px; display:flex; gap:10px; flex-wrap:wrap }

    /* Resultaten */
    .results{ display:grid; gap:12px }
    .bar{ height:10px; background:#f1f5f9; border:1.5px solid var(--line); border-radius:999px; overflow:hidden }
    .bar > div{ height:100%; background: var(--accent); width:0% }

    footer{ margin:28px 0 50px; text-align:center }
    .sharebar{ display:flex; gap:10px; justify-content:center; align-items:center; flex-wrap:wrap; color:var(--muted); font-size:13px }
    .sharebar a, .sharebar button{ all:unset; cursor:pointer; color:#4b5563; padding:6px 8px; border-radius:6px; display:inline-flex; align-items:center; gap:8px }
    .sharebar a:hover, .sharebar button:hover{ background:#f3f4f6 }
    .icon{ width:18px; height:18px; display:inline-block }
    .fb{ color:#1877F2 } .x{ color:#000 } .ig svg path{ fill:url(#igGradient) } .wa{ color:#25D366 }

    /* Over modal */
    .modal{ position:fixed; inset:0; display:none; align-items:center; justify-content:center; z-index:50 }
    .modal[aria-hidden="false"]{ display:flex }
    .backdrop{ position:absolute; inset:0; background:rgba(0,0,0,.45) }
    .sheet{ position:relative; background:#fff; width:min(760px, calc(100% - 28px)); max-height:85vh; border-radius:10px; border:1.5px solid var(--line); overflow:auto; padding:18px }
    .sheet h2{ margin:0 0 6px; font-size:20px }
    .sheet h3{ margin:18px 0 6px; font-size:16px }
    .sheet .close{ position:absolute; top:8px; right:8px }
    .donate{ display:inline-flex; align-items:center; gap:8px; background:#16a34a; color:#fff; border:0; padding:10px 14px; border-radius:8px; cursor:pointer; text-decoration:none }

    /* Responsive */
    @media (max-width: 740px){
      main{ margin:20px auto }
      .scale{ grid-template-columns: repeat(2, 1fr); }
      .question{ font-size:18px }
      .actions .btn{ flex:1 }
    }
    @media (max-width: 480px){
      .scale{ grid-template-columns: 1fr; }
      header h1{ font-size:16px }
      .title{ font-size:18px }
      .option{ min-height:54px; padding:14px }
      .qwrap{ padding:12px }
    }
  
    /* === Hero achtergrond alleen op Pagina 1 (Intro) === */
/* (oude block overschreven door v2 hieronder) */

    body.hero-intro{
      background-image: url('the-hague-993433.jpg'); /* zet dit pad desnoods naar /img/hero.jpg */
      background-size: cover;
      background-position: center;
      background-attachment: fixed;
    }
    /* Subtiele witte waas voor betere leesbaarheid van tekst boven de foto */
    body.hero-intro::after{
      content: "";
      position: fixed;
      inset: 0;
      background: rgba(255,255,255,.65);
      pointer-events: none;
      z-index: 0;
    }
    /* Zorg dat content altijd boven de overlay staat */
    header, main, footer, .modal{ position: relative; z-index: 1; }

  
    /* === Hero achtergrond alleen op Pagina 1 (Intro) ‚Äî v2 (gradient + glass) === */
    body.hero-intro{
      background-image: url('the-hague-993433.jpg');
      background-size: cover;
      background-position: center 20%;
      background-attachment: fixed;
    }
    /* Gradient overlay die van bijna transparant naar wit loopt (betere overgang met witte UI) */
    body.hero-intro::after{
      content: "";
      position: fixed;
      inset: 0;
      background: linear-gradient(to bottom,
                  rgba(255,255,255,.15) 0%,
                  rgba(255,255,255,.35) 35%,
                  rgba(255,255,255,.65) 65%,
                  rgba(255,255,255,1) 100%);
      pointer-events: none;
      z-index: 0;
    }
    /* Header en Intro-kaart krijgen 'glass' look zodat foto subtiel doorschemert */
    body.hero-intro header{
      background: rgba(255,255,255,.65);
      backdrop-filter: blur(6px) saturate(1.05);
      -webkit-backdrop-filter: blur(6px) saturate(1.05);
      border-color: rgba(255,255,255,.6);
      box-shadow: 0 8px 24px rgba(0,0,0,.08);
    }
    body.hero-intro #intro.card{
      background: rgba(255,255,255,.72);
      backdrop-filter: blur(8px) saturate(1.05);
      -webkit-backdrop-filter: blur(8px) saturate(1.05);
      border-color: rgba(255,255,255,.65);
      box-shadow: 0 16px 40px rgba(0,0,0,.14);
    }
    /* Klein detail: zachte rand binnenin het intro-paneel voor extra diepte */
    body.hero-intro #intro.card::before{
      content:"";
      position:absolute;
      inset:0;
      border-radius: inherit;
      box-shadow: inset 0 1px 0 rgba(255,255,255,.6), inset 0 0 40px rgba(255,255,255,.2);
      pointer-events:none;
    }

  
    /* Scroll lock when modal open */
    html.modal-open, body.modal-open{ overflow:hidden; }

    /* Animate the modal sheet for a snappier 'pop' */
    .modal .sheet{ transform: translateY(8px); opacity:.0; transition: transform .18s ease, opacity .18s ease }
    .modal[aria-hidden="false"] .sheet{ transform: translateY(0); opacity:1 }

  </style>
</head>
<body>
  <header>
    <div class="header-inner">
      <h1>eenvoudige stemwijzer</h1>
      <div class="header-actions">
        <button id="aboutOpen" class="btn" aria-haspopup="dialog" aria-controls="aboutModal">Over</button>
      </div>
    </div>
  </header>

  <main>
    <!-- Intro -->
    <section id="intro" class="card">
      <p class="title">Kies je soort vraag</p>
      <p class="subtitle">Kies de stijl die je fijn vindt</p>
      <div class="actions" style="margin-top:8px">
        <button class="btn" id="modeStandaard">Standaard vragen</button>
        <button class="btn" id="modeSimpel">Eenvoudige vragen</button>
      </div>
    </section>

    <!-- Quiz -->
    <section id="quiz" class="card" hidden>
      <div class="row" style="justify-content:space-between; align-items:center">
        <div class="pill" id="themePill">Thema</div>
        <div class="status" id="statusBadge"><span class="emoji" id="statusEmoji">üåç</span><span id="counter">Vraag 1 / 30</span></div>
      </div>

      <div class="progress" aria-hidden="true"><div id="progressFill" class="fill"></div></div>

      <div class="qwrap">
        <div class="question" id="questionText"></div>
        <div class="explain" id="explainText"></div>
        <button id="toggleExplain" class="btn-link" style="margin-top:6px">Toon uitleg</button>
      </div>

      <div class="scale" id="options"></div>

      <div class="quiz-actions">
        <button class="btn" id="prevBtn">Vorige</button>
        <button class="btn btn-quiet" id="nextBtn">Volgende</button>
        <button class="btn" id="skipBtn">Overslaan</button>
        <button class="btn btn-primary" id="showResultsBtn" hidden>Toon resultaten</button>
        <button class="btn-link" id="toggleSimple">Eenvoudige vragen</button>
      </div>
    </section>

    <!-- Resultaten -->
    <section id="results" class="card" hidden>
      <p class="title">Resultaat</p>
      <p class="subtitle">Zo goed passen je antwoorden bij de partijstandpunten.</p>
      <div id="resultsList" class="results"></div>
      <div class="actions" style="margin-top:16px">
        <button class="btn" id="retry">Opnieuw invullen</button>
      </div>
    </section>

    <!-- Footer share -->
    <footer>
      <div class="sharebar">
        <span>Deel deze website:</span>
        <!-- Instagram (gradient) -->
        <a id="shareIG" class="ig" href="#" target="_blank" rel="noopener" aria-label="Deel op Instagram">
          <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
            <defs>
              <linearGradient id="igGradient" x1="0" y1="0" x2="1" y2="1">
                <stop offset="0%" stop-color="#F58529"/>
                <stop offset="50%" stop-color="#DD2A7B"/>
                <stop offset="100%" stop-color="#8134AF"/>
              </linearGradient>
            </defs>
            <path d="M7 2h10a5 5 0 0 1 5 5v10a5 5 0 0 1-5 5H7a5 5 0 0 1-5-5V7a5 5 0 0 1 5-5zm0 2a3 3 0 0 0-3 3v10a3 3 0 0 0 3 3h10a3 3 0 0 0 3-3V7a3 3 0 0 0-3-3H7zm5 3.5a5.5 5.5 0 1 1 0 11 5.5 5.5 0 0 1 0-11zm0 2a3.5 3.5 0 1 0 0 7 3.5 3.5 0 0 0 0-7zm6-2.75a1.25 1.25 0 1 1 0 2.5 1.25 1.25 0 0 1 0-2.5z"/>
          </svg>
          Instagram
        </a>
        <!-- Facebook -->
        <a id="shareFB" class="fb" href="#" target="_blank" rel="noopener" aria-label="Deel op Facebook">
          <svg class="icon" viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M22 12.06C22 6.5 17.52 2 12 2S2 6.5 2 12.06C2 17.1 5.66 21.24 10.44 22v-7.03H7.9V12h2.54V9.8c0-2.5 1.49-3.88 3.77-3.88 1.09 0 2.23.2 2.23.2v2.46h-1.26c-1.24 0-1.63.77-1.63 1.56V12h2.78l-.44 2.97h-2.34V22C18.34 21.24 22 17.1 22 12.06Z"/></svg>
          Facebook
        </a>
        <!-- X (Twitter) -->
        <a id="shareX" class="x" href="#" target="_blank" rel="noopener" aria-label="Deel op X">
          <svg class="icon" viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M17.05 2H20l-6.66 7.6L21.5 22h-6.2l-4.86-6.25L4.9 22H2l7.14-8.16L2.8 2h6.26l4.38 5.76L17.05 2Zm-1.09 18h1.7L8.17 4h-1.8l9.59 16Z"/></svg>
          X
        </a>
        <!-- WhatsApp -->
        <a id="shareWA" class="wa" href="#" target="_blank" rel="noopener" aria-label="Deel via WhatsApp">
          <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
            <path fill="currentColor" d="M.057 24l1.687-6.163A10.9 10.9 0 1 1 6.404 22.66L.057 24zm6.597-3.807a9.04 9.04 0 1 0-3.134-3.133L3.2 20.8l3.454-1.607zm11.387-5.464c-.197-.098-1.16-.57-1.34-.636-.18-.066-.31-.098-.44.098-.13.197-.504.636-.617.767-.114.13-.227.147-.424.049-.197-.098-.832-.306-1.585-.976-.586-.522-.98-1.165-1.096-1.362-.114-.197-.012-.303.086-.401.09-.089.197-.23.296-.345.098-.114.13-.197.197-.328.066-.13.033-.246-.016-.345-.049-.098-.44-1.06-.603-1.455-.158-.381-.319-.33-.44-.335-.114-.005-.246-.006-.377-.006-.13 0-.345.049-.526.246-.18.197-.691.676-.691 1.65s.707 1.915.806 2.049c.098.13 1.39 2.117 3.367 2.967.471.203.84.325 1.128.417.474.151.905.13 1.246.079.38-.056 1.16-.474 1.325-.932.164-.458.164-.848.114-.932-.049-.084-.18-.13-.377-.23z"/>
          </svg>
          WhatsApp
        </a>
        <button id="copyLink" class="btn" aria-label="Kopieer link">üîó Kopieer link</button>
      </div>
    </footer>
  </main>

  <!-- Over modal -->
  <div id="aboutModal" class="modal" aria-hidden="true" role="dialog" aria-labelledby="aboutTitle">
    <div class="backdrop" id="aboutBackdrop"></div>
    <div class="sheet" tabindex="-1" role="document" aria-describedby="aboutBody">
      <button id="aboutClose" class="btn close" aria-label="Sluiten">‚úï</button>
      <h2 id="aboutTitle">Over deze stemwijzer</h2>
      <p id="aboutBody">Doel: je snel een <strong>indicatie</strong> geven welke partijstandpunten het meest overeenkomen met jouw antwoorden. Alles draait in je browser; er wordt niets opgeslagen.</p>
      <h3>Veelgestelde vragen</h3>
      <ul>
        <li><strong>Hoe werkt het matchen?</strong> Per stelling vergelijken we jouw keuze (-2 t/m +2) met partijposities. Hoe dichterbij, hoe hoger het percentage.</li>
        <li><strong>Is dit officieel?</strong> Nee. Het is een onafhankelijke, eenvoudige tool op basis van verkiezingsprogramma‚Äôs.</li>
        <li><strong>Privacy?</strong> Antwoorden blijven lokaal in je browser.</li>
      </ul>
      <h3>Welke verkiezingsprogramma‚Äôs zijn meegenomen?</h3>
      <ul>
        <li>BBB ‚Äî programma nov 2023</li>
        <li>VVD ‚Äî programma 2023‚Äì2027</li>
        <li>CDA ‚Äî programma 2023‚Äì2027</li>
        <li>GroenLinks‚ÄìPvdA ‚Äî programma 2023</li>
      </ul>
      <p>Bronnen (PDF‚Äôs):
        <a href="https://boerburgerbeweging.nl/wp-content/uploads/2023/10/BBB_VERKIEZINGSPROGRAMMA_NOV2023_Corr5.pdf" target="_blank" rel="noopener">BBB</a> ¬∑
        <a href="https://www.vvd.nl/wp-content/uploads/2023/10/Verkiezingsprogramma-VVD-2023-2027-1.pdf" target="_blank" rel="noopener">VVD</a> ¬∑
        <a href="https://dnpprepo.ub.rug.nl/87714/7/CDA%20Verkiezingsprogramma%202023-2027.pdf" target="_blank" rel="noopener">CDA</a> ¬∑
        <a href="https://groenlinkspvda.nl/wp-content/uploads/2023/10/VKP-DEF-1.pdf" target="_blank" rel="noopener">GL-PvdA</a>
      </p>
      <h3>Contact</h3>
      <p>Heb je feedback? Stuur een mail naar <a href="mailto:jouw@mailadres.nl">jouw@mailadres.nl</a> (pas dit aan in de HTML).</p>
      <h3>Doneren</h3>
      <p>Wil je dit vrijwillige project steunen? Doneer via <a href="https://www.gofundme.com/nl-nl" target="_blank" rel="noopener">GoFundMe</a>.</p>
    </div>
  </div>

  <script>
    // ===== Config =====
    // Toon hero-achtergrond op de intro-pagina
    document.body.classList.add('hero-intro');
    const ADVANCE_DELAY = 350; // ms auto-door naar volgende vraag na keuze

    // Deel-URL
    const SHARE_URL_FALLBACK = 'https://r88h.github.io/eenvoudige-stemwijzer/';
    const getShareUrl = () => { try{ const {protocol,href} = window.location; if(protocol.startsWith('http')) return href; }catch(e){} return SHARE_URL_FALLBACK; };

    // Thema ‚Üí icoon mapping (emoji / svg)
    const tankSVG = '<svg viewBox="0 0 64 32" xmlns="http://www.w3.org/2000/svg" style="vertical-align:middle"><rect x="8" y="14" width="40" height="10" rx="2" ry="2" fill="currentColor"/><rect x="18" y="10" width="16" height="6" rx="1" ry="1" fill="currentColor"/><rect x="48" y="15" width="12" height="2" fill="currentColor"/></svg>';
    function themeIcon(thema){
      switch(thema){
        case 'Klimaat': return 'üåç';
        case 'Migratie': return 'üß≥';
        case 'Economie': return 'üìà';
        case 'Zorg': return 'ü©∫';
        case 'Onderwijs': return 'üéì';
        case 'Defensie': return tankSVG; // grotere tank
        case 'Natuur': return 'üå≥';
        case 'Bestuur': return 'üèõÔ∏è';
        default: return 'ü§ì';
      }
    }

    // ===== DATA ‚Äì (voorbeeld) 30 stellingen; ongewijzigd =====
    const data = { stellingen: [
      { id:1,  thema:'Klimaat',   tekst:'CO‚ÇÇ-heffing voor bedrijven moet worden afgeschaft', simpel:'Schaf de extra CO‚ÇÇ-belasting voor bedrijven af', uitleg:'Afschaffen verlaagt kosten voor bedrijven, maar vermindert de prikkel om te verduurzamen.', simpelUitleg:'Goedkoper voor bedrijven, minder druk om schoner te worden.', partijen:{BBB:2, VVD:-1, CDA:-1, GLPvdA:-2} },
      { id:2,  thema:'Klimaat',   tekst:'Zero-emissiezones in steden moeten worden opgeheven', simpel:'Stop met milieuzones in steden', uitleg:'Opheffen maakt rijden en bezorgen makkelijker, maar verslechtert lokaal de luchtkwaliteit.', simpelUitleg:'Makkelijker rijden, maar slechtere lucht.', partijen:{BBB:2, VVD:-1, CDA:-1, GLPvdA:-2} },
      { id:3,  thema:'Klimaat',   tekst:'Extra regels voor dierwaardige veehouderij zijn niet nodig', simpel:'Geen extra dierenwelzijnsregels voor boeren', uitleg:'Minder regels verlaagt kosten, maar remt gewenste verbeteringen in dierenwelzijn.', simpelUitleg:'Goedkoper voor boeren, minder voor dieren.', partijen:{BBB:2, VVD:-1, CDA:-1, GLPvdA:-2} },
      { id:4,  thema:'Klimaat',   tekst:'Beperk klimaatbeleid als dat nodig is voor economische groei en leefbaarheid van het platteland', simpel:'Minder klimaatregels als dat beter is voor regio en economie', uitleg:'Kan regionale economie helpen, maar vertraagt CO‚ÇÇ-reductie en klimaatdoelen.', simpelUitleg:'Goed voor regio, minder snel klimaatdoelen.', partijen:{BBB:2, VVD:1, CDA:0, GLPvdA:-2} },
      { id:5,  thema:'Klimaat',   tekst:'Kerncentrales blijven open en kolencentrales mogen langer door voor energiezekerheid', simpel:'Kernenergie en kolen langer openhouden voor betrouwbare stroom', uitleg:'Verhoogt leveringszekerheid, maar schaadt klimaatdoelen en natuur door kolen.', simpelUitleg:'Betrouwbare stroom, slechter voor klimaat.', partijen:{BBB:2, VVD:1, CDA:1, GLPvdA:-2} },
      { id:6,  thema:'Klimaat',   tekst:'Uitbreiding van windparken op zee moet voorlopig pauzeren', simpel:'Even stoppen met extra wind op zee', uitleg:'Geeft ruimte aan natuur/visserij, maar remt groei van duurzame energie.', simpelUitleg:'Rust voor zee, minder groene stroom.', partijen:{BBB:2, VVD:-1, CDA:-1, GLPvdA:-2} },
      // Migratie
      { id:7,  thema:'Migratie',  tekst:'Asielbeleid moet strenger met strengere toelating en grenscontroles', simpel:'Strenger asiel en grenzen', uitleg:'Kan instroom beperken, maar leidt tot langere procedures en spanning met verdragen.', simpelUitleg:'Minder instroom, meer strenge regels.', partijen:{BBB:2, VVD:2, CDA:1, GLPvdA:-2} },
      { id:8,  thema:'Migratie',  tekst:'Illegale migratie moet strafbaar worden', simpel:'Illegaal binnenkomen strafbaar', uitleg:'Vergroot afschrikking, maar brengt juridische en praktische problemen mee.', simpelUitleg:'Hardere aanpak, lastig uitvoerbaar.', partijen:{BBB:2, VVD:2, CDA:1, GLPvdA:-2} },
      { id:9,  thema:'Migratie',  tekst:'Statushouders verliezen hun vergunning als ze naar het land van herkomst reizen', simpel:'Ga je terug naar je land? Vergunning kwijt', uitleg:'Voorkomt misbruik, maar kan botsen met nood- of familiebezoek.', simpelUitleg:'Misbruik voorkomen, soms onhandig.', partijen:{BBB:2, VVD:1, CDA:1, GLPvdA:-2} },
      { id:10, thema:'Migratie',  tekst:'Migranten moeten verplicht Nederlands leren en meedoen', simpel:'Verplicht Nederlands leren en meedoen', uitleg:'Bevordert integratie, maar voelt voor sommigen dwingend.', simpelUitleg:'Helpt meedoen, maar verplicht.', partijen:{BBB:2, VVD:2, CDA:2, GLPvdA:1} },
      // Economie
      { id:11, thema:'Economie',  tekst:'Economische belangen van regio‚Äôs krijgen voorrang boven strikte klimaatregels', simpel:'Regio en banen gaan voor op strenge klimaatregels', uitleg:'Kan investeringen aantrekken, maar bemoeilijkt klimaatdoelen.', simpelUitleg:'Meer banen, klimaat lastiger.', partijen:{BBB:2, VVD:1, CDA:1, GLPvdA:-2} },
      { id:12, thema:'Economie',  tekst:'Minder papierwerk en regels voor mkb en boeren', simpel:'Schrap regels voor mkb en boeren', uitleg:'Vermindert lasten en stimuleert ondernemen, maar toezicht wordt lastiger.', simpelUitleg:'Minder papier, sneller werken.', partijen:{BBB:2, VVD:2, CDA:2, GLPvdA:1} },
      { id:13, thema:'Economie',  tekst:'Behoud van regionale voorzieningen krijgt prioriteit', simpel:'Dorpsziekenhuis en school openhouden', uitleg:'Houdt dorpen leefbaar, kost structureel geld.', simpelUitleg:'Fijn voor dorpen, kost geld.', partijen:{BBB:2, VVD:0, CDA:2, GLPvdA:1} },
      { id:14, thema:'Economie',  tekst:'Lelystad Airport kan open, liefst met ook een militaire functie', simpel:'Lelystad open (ook militair)', uitleg:'Geeft extra capaciteit en strategisch nut, maar meer uitstoot en overlast.', simpelUitleg:'Meer vliegen, meer geluid.', partijen:{BBB:1, VVD:2, CDA:1, GLPvdA:-2} },
      { id:15, thema:'Economie',  tekst:'De overheid moet productie van kritieke medicijnen naar Nederland halen', simpel:'Maak belangrijke medicijnen in Nederland', uitleg:'Minder afhankelijk, maar duurder en vraagt investeringen.', simpelUitleg:'Minder afhankelijk, wel duurder.', partijen:{BBB:2, VVD:1, CDA:2, GLPvdA:1} },
      // Zorg
      { id:16, thema:'Zorg',      tekst:'Het basispakket moet meer vergoeden voor mondzorg en fysiotherapie', simpel:'Meer tandarts en fysio in basis', uitleg:'Helpt pati√´nten, maar verhoogt premies/belastingen.', simpelUitleg:'Meer vergoed, mogelijk duurder.', partijen:{BBB:1, VVD:-1, CDA:0, GLPvdA:2} },
      { id:17, thema:'Zorg',      tekst:'Minder management en administratie in de zorg', simpel:'Minder papier, meer zorg', uitleg:'Ontlast personeel, maar vraagt herinrichting en risico op minder aansturing.', simpelUitleg:'Meer tijd voor pati√´nten.', partijen:{BBB:2, VVD:1, CDA:1, GLPvdA:1} },
      { id:18, thema:'Zorg',      tekst:'Mantelzorg en vrijwilligers krijgen een grotere rol', simpel:'Meer inzet van familie en vrijwilligers', uitleg:'Verlicht druk op zorg, risico op overbelasting van mantelzorgers.', simpelUitleg:'Helpt zorg, kan zwaar zijn.', partijen:{BBB:2, VVD:1, CDA:2, GLPvdA:1} },
      { id:19, thema:'Zorg',      tekst:'Regioziekenhuizen moeten extra beschermd worden tegen sluiting', simpel:'Bescherm kleine ziekenhuizen tegen sluiting', uitleg:'Behoud nabijheid van zorg, maar niet altijd kosteneffectief.', simpelUitleg:'Zorg dichtbij, kost meer.', partijen:{BBB:2, VVD:0, CDA:2, GLPvdA:1} },
      // Onderwijs
      { id:20, thema:'Onderwijs',  tekst:'Onderwijs in regio‚Äôs moet extra versterkt worden', simpel:'Extra steun voor plattelandsscholen', uitleg:'Beperkt uitstroom naar steden, kost extra middelen.', simpelUitleg:'Scholen sterker, kost geld.', partijen:{BBB:2, VVD:1, CDA:2, GLPvdA:1} },
      { id:21, thema:'Onderwijs',  tekst:'Minder symboolpolitiek op scholen; focus op basisvakken', simpel:'Focus op taal, rekenen en kennis', uitleg:'Verhoogt basisvaardigheden; kan botsen met andere ontwikkeldoelen.', simpelUitleg:'Meer basis, minder franje.', partijen:{BBB:2, VVD:1, CDA:1, GLPvdA:-1} },
      { id:22, thema:'Onderwijs',  tekst:'Overheidscommunicatie en lesmateriaal zijn in duidelijke Nederlandse taal', simpel:'Overheid en school praten duidelijk Nederlands', uitleg:'Maakt beleid en lesstof toegankelijker; kan botsen met meertaligheid.', simpelUitleg:'Makkelijk Nederlands helpt.', partijen:{BBB:2, VVD:2, CDA:2, GLPvdA:1} },
      // Defensie & Bestuur & Natuur
      { id:23, thema:'Defensie',  tekst:'Nederland hoeft niet te voldoen aan hogere NAVO-doelen zoals 3,5% van het bbp', simpel:'Geen verplicht 3,5% bbp voor defensie', uitleg:'Geeft begrotingsruimte, maar zet reputatie in bondgenootschap onder druk.', simpelUitleg:'Meer geld vrij, bondgenoten minder blij.', partijen:{BBB:1, VVD:-1, CDA:-1, GLPvdA:-1} },
      { id:24, thema:'Defensie',  tekst:'We investeren extra in defensie; minstens de helft van het materieel komt uit Nederland', simpel:'Investeer in defensie en koop veel in NL', uitleg:'Versterkt krijgsmacht en industrie; risico op hogere kosten en minder keuze.', simpelUitleg:'Sterker leger, mogelijk duurder.', partijen:{BBB:2, VVD:1, CDA:1, GLPvdA:0} },
      { id:25, thema:'Defensie',  tekst:'We steunen Oekra√Øne, maar niet ten koste van AOW of zorg', simpel:'Steun Oekra√Øne, AOW en zorg gaan voor', uitleg:'Biedt steun met begrenzing; kan tot discussies over prioriteiten leiden.', simpelUitleg:'Helpen ja, maar grenzen.', partijen:{BBB:1, VVD:0, CDA:0, GLPvdA:0} },
      { id:26, thema:'Bestuur',   tekst:'Benoemingen bij de Raad van State worden transparanter en neutraler', simpel:'Raad van State eerlijker benoemen', uitleg:'Meer transparantie vergroot vertrouwen; uitwerking is bepalend.', simpelUitleg:'Eerlijker en duidelijker.', partijen:{BBB:2, VVD:1, CDA:1, GLPvdA:1} },
      { id:27, thema:'Bestuur',   tekst:'De NVWA wordt onafhankelijker van het ministerie', simpel:'NVWA werkt onafhankelijker', uitleg:'Scheiding van beleid en toezicht vergroot vertrouwen; vraagt reorganisatie.', simpelUitleg:'Meer vertrouwen, organisatie aanpassen.', partijen:{BBB:2, VVD:1, CDA:1, GLPvdA:1} },
      { id:28, thema:'Natuur',    tekst:'Wolven mogen gevolgd en zo nodig afgeschoten worden bij bedreiging van veiligheid of leefbaarheid', simpel:'Wolven volgen en zo nodig afschieten', uitleg:'Zoekt balans tussen natuur en veiligheid; juridische voorwaarden zijn streng.', simpelUitleg:'Veiligheid eerst, regels streng.', partijen:{BBB:2, VVD:1, CDA:2, GLPvdA:-1} },
      { id:29, thema:'Economie',  tekst:'Bedrijfsleven eerst versterken; daarna versnellen met klimaatdoelen', simpel:'Eerst economie aanjagen, dan klimaat versnellen', uitleg:'Kan groei opleveren; uitstootreductie kan vertragen.', simpelUitleg:'Meer banen nu, klimaat later.', partijen:{BBB:2, VVD:1, CDA:0, GLPvdA:-2} },
      { id:30, thema:'Natuur',    tekst:'Natuurherstel mag niet ten koste gaan van leefbaarheid in regio‚Äôs', simpel:'Natuurherstel mag niet ten koste van regio', uitleg:'Afweging tussen leefbaarheid en natuurdoelen; uitvoering is bepalend.', simpelUitleg:'Balans zoeken; hangt van plannen af.', partijen:{BBB:2, VVD:1, CDA:1, GLPvdA:-1} },
    ]};

    const ANSWER_SCALE = [
      { label:'Helemaal mee oneens', value:-2 },
      { label:'Mee oneens', value:-1 },
      { label:'Neutraal / geen mening', value:0 },
      { label:'Mee eens', value:1 },
      { label:'Helemaal mee eens', value:2 },
    ];

    // ===== State =====
    let mode = 'standaard'; // 'standaard' | 'simpel'
    let idx = 0;          // huidige vraag index
    const answers = new Map();
    let explainOpen = false; // standaard verborgen, sluit weer na keuze
    let advancing = false;

    // Helpers
    const $ = sel => document.querySelector(sel);
    const el = (t,props={}) => Object.assign(document.createElement(t), props);

    const uniqueParties = () => { const set = new Set(); data.stellingen.forEach(s => Object.keys(s.partijen).forEach(p => set.add(p))); return Array.from(set); };

    const updateProgress = () => {
      const total = data.stellingen.length;
      const pct = Math.round(((idx + 1) / total) * 100); // exact gelijk aan "Vraag x/30"
      $('#progressFill').style.width = pct + '%';
    };

    const setStatus = () => {
      const s = data.stellingen[idx];
      $('#themePill').textContent = s.thema || 'Thema';
      const icon = themeIcon(s.thema);
      const emojiSpan = $('#statusEmoji');
      if(typeof icon === 'string' && icon.startsWith('<svg')){ emojiSpan.innerHTML = icon; }
      else if(typeof icon === 'string'){ emojiSpan.textContent = icon; }
      else { emojiSpan.textContent = '‚ú®'; }
      $('#counter').textContent = `Vraag ${idx+1} / ${data.stellingen.length}`;
      const badge = $('#statusBadge'); badge.classList.remove('pop'); void badge.offsetWidth; badge.classList.add('pop');
    };

    function spawnFlyIcon(optNode){
      const s = data.stellingen[idx];
      const icon = themeIcon(s.thema);
      const node = document.createElement('span');
      node.className = 'fly';
      if(typeof icon === 'string' && icon.startsWith('<svg')){ node.innerHTML = icon; node.style.width='18px'; node.style.height='18px'; }
      else { node.textContent = icon; }
      node.style.left = '50%'; node.style.top = '8px'; node.style.transform = 'translate(-50%, 6px) scale(.9)';
      optNode.appendChild(node);
      node.addEventListener('animationend', () => node.remove());
    }

    const renderQuestion = () => {
      const s = data.stellingen[idx];
      $('#questionText').textContent = (mode === 'simpel') ? s.simpel : s.tekst;
      $('#explainText').textContent  = (mode === 'simpel') ? s.simpelUitleg : s.uitleg;
      $('#toggleExplain').textContent = explainOpen ? 'Verberg uitleg' : 'Toon uitleg';
      $('#explainText').style.display = explainOpen ? 'block' : 'none';
      setStatus();

      const optWrap = $('#options'); optWrap.innerHTML = '';
      ANSWER_SCALE.forEach(opt => {
        const o = el('div', { className:'option', tabIndex:0 });
        o.dataset.value = String(opt.value);
        o.textContent = opt.label;
        if (answers.get(s.id) === opt.value) o.classList.add('selected');
        o.addEventListener('click', () => {
          if (advancing) return;
          advancing = true;
          answers.set(s.id, opt.value);
          document.querySelectorAll('.option').forEach(n => n.classList.remove('selected'));
          o.classList.add('selected');
          // korte bevestiging met thema-icoon in de optie (0.4s)
          spawnFlyIcon(o);
          // uitleg sluiten voor volgende vraag
          explainOpen = false; $('#explainText').style.display = 'none'; $('#toggleExplain').textContent = 'Toon uitleg';
          updateProgress();
          setTimeout(() => { goNext(); advancing = false; }, ADVANCE_DELAY);
        });
        o.addEventListener('keydown', e => { if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); o.click(); } });
        optWrap.appendChild(o);
      });

      $('#prevBtn').disabled = idx === 0;
      const last = idx === data.stellingen.length - 1;
      $('#nextBtn').hidden = last;
      $('#showResultsBtn').hidden = !last;

      updateModeToggleLabel();
      updateProgress();
    };

    const computeMatches = () => {
      const parties = uniqueParties();
      return parties.map(party => {
        let sum = 0, n = 0;
        data.stellingen.forEach(s => {
          const user = answers.get(s.id);
          if (typeof user !== 'number') return;
          const ps = s.partijen[party];
          if (typeof ps !== 'number') return;
          const diff = Math.abs(user - ps);
          sum += 1 - (diff / 4); n += 1;
        });
        const pct = n ? Math.round((sum / n) * 100) : 0;
        return { party, pct, n };
      }).sort((a,b)=>b.pct-a.pct);
    };

    const showResults = () => {
      const list = $('#resultsList'); list.innerHTML = '';
      const res = computeMatches();
      if (!res.length) { list.appendChild(el('p',{textContent:'Geen resultaten (geen antwoorden of geen partij-standpunten).'})); return; }
      res.forEach(r => {
        const row = el('div');
        row.innerHTML = `<div style="display:flex; justify-content:space-between; align-items:center; gap:12px">
            <div style="display:flex; align-items:center; gap:10px">
              <strong>${r.party}</strong>
              <span class="pill">${r.n} stellingen vergeleken</span>
            </div>
            <strong>${r.pct}%</strong>
          </div>
          <div class="bar"><div style="width:${r.pct}%"></div></div>`;
        list.appendChild(row);
      });
    };

    const goNext = () => {
      if (idx < data.stellingen.length - 1) { idx++; renderQuestion(); window.scrollTo({top:0, behavior:'instant'}); }
      else { $('#quiz').hidden = true; $('#results').hidden = false; showResults(); }
    };

    const goPrev = () => { if (idx>0){ idx--; renderQuestion(); window.scrollTo({top:0, behavior:'instant'}); } };
    const skip = () => { if (idx < data.stellingen.length - 1) { idx++; renderQuestion(); } else { $('#quiz').hidden = true; $('#results').hidden = false; showResults(); } };

    const resetAll = () => { answers.clear(); idx = 0; explainOpen = false; };

    const updateModeToggleLabel = () => {
      const btn = $('#toggleSimple');
      btn.textContent = (mode === 'standaard') ? 'Eenvoudige vragen' : 'Standaard vragen';
    };

    function startQuiz(chosenMode){
      mode = chosenMode; // 'standaard' of 'simpel'
      resetAll();
      $('#intro').hidden = true; $('#results').hidden = true; $('#quiz').hidden = false;
      document.body.classList.remove('hero-intro');
      renderQuestion();
    }

    // Events
    $('#modeStandaard').addEventListener('click', () => startQuiz('standaard'));
    $('#modeSimpel').addEventListener('click', () => startQuiz('simpel'));

    $('#toggleSimple').addEventListener('click', () => { mode = (mode === 'standaard') ? 'simpel' : 'standaard'; renderQuestion(); });
    $('#toggleExplain').addEventListener('click', () => { explainOpen = !explainOpen; renderQuestion(); });

    $('#prevBtn').addEventListener('click', goPrev);
    $('#nextBtn').addEventListener('click', () => { if (!advancing) goNext(); });
    $('#skipBtn').addEventListener('click', skip);
    $('#showResultsBtn').addEventListener('click', () => { $('#quiz').hidden = true; $('#results').hidden = false; showResults(); });

    $('#retry').addEventListener('click', () => { resetAll(); $('#results').hidden = true; $('#intro').hidden = false; document.body.classList.add('hero-intro'); });

    // Over modal logic
    const aboutModal = document.getElementById('aboutModal');
    const openAbout = () => { aboutModal.setAttribute('aria-hidden','false'); document.documentElement.classList.add('modal-open'); document.body.classList.add('modal-open'); setTimeout(()=> aboutModal.querySelector('.sheet').focus(), 0); };
    const closeAbout = () => { aboutModal.setAttribute('aria-hidden','true'); document.documentElement.classList.remove('modal-open'); document.body.classList.remove('modal-open'); };
    document.getElementById('aboutOpen').addEventListener('click', ()=>{ window.scrollTo({top:0, behavior:'instant'}); openAbout(); });
    document.getElementById('aboutClose').addEventListener('click', closeAbout);
    document.getElementById('aboutBackdrop').addEventListener('click', closeAbout);
    document.addEventListener('keydown', (e)=>{ if(e.key==='Escape') closeAbout(); });

    // Social links + kopieer
    const url = getShareUrl();
    const shareText = 'Check deze stemwijzer:';
    document.getElementById('shareIG').href = 'https://www.instagram.com/?url=' + encodeURIComponent(url);
    document.getElementById('shareFB').href = 'https://www.facebook.com/sharer/sharer.php?u=' + encodeURIComponent(url);
    document.getElementById('shareX').href  = 'https://twitter.com/intent/tweet?text=' + encodeURIComponent(shareText) + '&url=' + encodeURIComponent(url);
    document.getElementById('shareWA').href = 'https://wa.me/?text=' + encodeURIComponent(shareText + ' ' + url);
    document.getElementById('copyLink').addEventListener('click', async () => {
      try{ await navigator.clipboard.writeText(url); alert('Dank je wel üôÇ. De link is gekopieerd.'); }catch(e){ prompt('Kopieer de link:', url); }
    });
  </script>
</body>
</html>
